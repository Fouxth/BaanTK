# ğŸ¦ BaanTK - à¸£à¸°à¸šà¸šà¸ˆà¸±à¸”à¸à¸²à¸£à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­à¸­à¸­à¸™à¹„à¸¥à¸™à¹Œà¹à¸šà¸šà¸„à¸£à¸šà¸§à¸‡à¸ˆà¸£

![BaanTK Banner](baan-tk.png)

**à¸£à¸°à¸šà¸šà¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­à¸­à¸­à¸™à¹„à¸¥à¸™à¹Œà¸—à¸µà¹ˆà¸—à¸±à¸™à¸ªà¸¡à¸±à¸¢** à¸à¸±à¸’à¸™à¸²à¸”à¹‰à¸§à¸¢ Firebase, LINE Bot API à¹à¸¥à¸° LIFF à¸à¸£à¹‰à¸­à¸¡ Admin Dashboard à¸ªà¸³à¸«à¸£à¸±à¸šà¸ˆà¸±à¸”à¸à¸²à¸£à¸˜à¸¸à¸£à¸à¸´à¸ˆà¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­

[![Firebase](https://img.shields.io/badge/Firebase-Functions-orange?logo=firebase)](https://firebase.google.com/)
[![LINE](https://img.shields.io/badge/LINE-Bot%20API-00C300?logo=line)](https://developers.line.biz/)
[![Node.js](https://img.shields.io/badge/Node.js-18+-green?logo=node.js)](https://nodejs.org/)
[![License](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)

---

## ğŸ¯ **Overview**

BaanTK à¹€à¸›à¹‡à¸™à¸£à¸°à¸šà¸šà¸ˆà¸±à¸”à¸à¸²à¸£à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­à¸­à¸­à¸™à¹„à¸¥à¸™à¹Œà¸—à¸µà¹ˆà¸„à¸£à¸šà¸§à¸‡à¸ˆà¸£ à¸£à¸­à¸‡à¸£à¸±à¸šà¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸œà¹ˆà¸²à¸™ LINE Bot, LIFF Application à¹à¸¥à¸° Admin Dashboard à¸à¸£à¹‰à¸­à¸¡à¸£à¸°à¸šà¸šà¸£à¸±à¸à¸©à¸²à¸„à¸§à¸²à¸¡à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢à¹à¸¥à¸°à¸à¸²à¸£à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸±à¹‰à¸™à¸ªà¸¹à¸‡

### âœ¨ **Features**

#### ğŸ¤– **LINE Bot Integration**
- **à¹€à¸¡à¸™à¸¹à¹à¸šà¸š Carousel** - à¹à¸ªà¸”à¸‡à¸•à¸±à¸§à¹€à¸¥à¸·à¸­à¸à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™
- **à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸œà¹ˆà¸²à¸™ LIFF** - à¸à¸£à¸­à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸šà¸šà¸›à¸¥à¸­à¸”à¸ à¸±à¸¢ à¸à¸£à¹‰à¸­à¸¡à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸²à¸©à¸à¸£
- **à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸–à¸²à¸™à¸°** - à¸”à¸¹à¸ªà¸–à¸²à¸™à¸°à¸à¸²à¸£à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¹à¸¥à¸°à¸¢à¸­à¸”à¸„à¹‰à¸²à¸‡à¸Šà¸³à¸£à¸°
- **à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¹€à¸­à¸à¸ªà¸²à¸£** - à¸ªà¹ˆà¸‡à¸£à¸¹à¸›à¸šà¸±à¸•à¸£à¸›à¸£à¸°à¸Šà¸²à¸Šà¸™à¹à¸¥à¸°à¹€à¸­à¸à¸ªà¸²à¸£
- **à¸Šà¸³à¸£à¸°à¸œà¹ˆà¸²à¸™ QR Code** - PromptPay integration
- **à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´** - à¸£à¸°à¸šà¸š Scheduler à¸ªà¸³à¸«à¸£à¸±à¸šà¸§à¸±à¸™à¸„à¸£à¸šà¸à¸³à¸«à¸™à¸”

#### ğŸ›ï¸ **Government Registry Integration**
- **à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸²à¸©à¸à¸£** - à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡à¸ˆà¸²à¸à¸à¸£à¸¡à¸à¸²à¸£à¸›à¸à¸„à¸£à¸­à¸‡
- **à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸–à¸²à¸™à¸°à¸šà¸±à¸•à¸£à¸›à¸£à¸°à¸Šà¸²à¸Šà¸™** - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸à¸²à¸£à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸à¹à¸¥à¸°à¸ªà¸–à¸²à¸™à¸°à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™
- **à¹€à¸›à¸£à¸µà¸¢à¸šà¹€à¸—à¸µà¸¢à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥** - à¹€à¸›à¸£à¸µà¸¢à¸šà¹€à¸—à¸µà¸¢à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸à¸£à¸­à¸à¸à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡à¸ˆà¸²à¸à¸£à¸²à¸Šà¸à¸²à¸£
- **à¸”à¸¶à¸‡à¸›à¸£à¸°à¸§à¸±à¸•à¸´à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­** - à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸à¸±à¸šà¸à¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­à¹à¸«à¹ˆà¸‡à¸Šà¸²à¸•à¸´
- **à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆ** - à¸¢à¸·à¸™à¸¢à¸±à¸™à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¸ˆà¸²à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸šà¹‰à¸²à¸™

#### ï¿½â€ğŸ’¼ **Admin Dashboard**
- **Dashboard à¸„à¸£à¸šà¸„à¸£à¸±à¸™** - à¸ªà¸–à¸´à¸•à¸´, à¸à¸£à¸²à¸Ÿ, KPIs
- **à¸ˆà¸±à¸”à¸à¸²à¸£à¸œà¸¹à¹‰à¸à¸¹à¹‰à¹€à¸‡à¸´à¸™** - à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´/à¸›à¸à¸´à¹€à¸ªà¸˜ à¸„à¸³à¸‚à¸­à¹€à¸‡à¸´à¸™à¸à¸¹à¹‰
- **à¸£à¸°à¸šà¸š Credit Scoring** - à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡à¸”à¹‰à¸§à¸¢ AI
- **Blacklist Management** - à¸ˆà¸±à¸”à¸à¸²à¸£à¸¥à¸¹à¸à¸„à¹‰à¸²à¸›à¸±à¸à¸«à¸²
- **Payment Tracking** - à¸•à¸´à¸”à¸•à¸²à¸¡à¸à¸²à¸£à¸Šà¸³à¸£à¸°à¹€à¸‡à¸´à¸™
- **Advanced Reports** - à¸£à¸²à¸¢à¸‡à¸²à¸™à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸˜à¸¸à¸£à¸à¸´à¸ˆ

#### ğŸ”’ **Security & Performance**
- **Rate Limiting** - à¸›à¹‰à¸­à¸‡à¸à¸±à¸™ DDoS à¹à¸¥à¸° Brute Force
- **Input Validation** - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸›à¹‰à¸­à¸™à¹€à¸‚à¹‰à¸²
- **CORS Configuration** - à¸„à¸§à¸šà¸„à¸¸à¸¡à¸à¸²à¸£à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡
- **Admin Authentication** - à¸£à¸°à¸šà¸š Token-based auth
- **Error Handling** - à¸ˆà¸±à¸”à¸à¸²à¸£à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”à¹à¸šà¸šà¸„à¸£à¸šà¸–à¹‰à¸§à¸™

---

## ğŸ“ **Project Structure**

```
BaanTK/
â”œâ”€â”€ ğŸ“‚ functions/                     # Firebase Cloud Functions
â”‚   â”œâ”€â”€ ğŸš€ index.js                   # Main API server & LINE webhook
â”‚   â”œâ”€â”€ ğŸ›ï¸ governmentAPI.js           # à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸à¸±à¸šà¸£à¸°à¸šà¸šà¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸²à¸©à¸à¸£
â”‚   â”œâ”€â”€ ğŸ”’ security.js                # à¸£à¸°à¸šà¸šà¸£à¸±à¸à¸©à¸²à¸„à¸§à¸²à¸¡à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢
â”‚   â”œâ”€â”€ âœ… validation.js              # à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸›à¹‰à¸­à¸™à¹€à¸‚à¹‰à¸²
â”‚   â”œâ”€â”€ ğŸ“Š creditScoring.js           # à¸£à¸°à¸šà¸šà¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡
â”‚   â”œâ”€â”€ â° dueNotifier.js             # à¸£à¸°à¸šà¸šà¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸„à¸£à¸šà¸à¸³à¸«à¸™à¸”
â”‚   â”œâ”€â”€ ğŸ“± menuFlex.js               # LINE Menu template
â”‚   â”œâ”€â”€ ğŸ“ flexRegisterTemplate.js   # Registration template
â”‚   â”œâ”€â”€ ğŸ‰ welcomeFlex.js            # Welcome message template
â”‚   â”œâ”€â”€ ğŸ“Š statusFlex.js             # Status display template
â”‚   â”œâ”€â”€ ğŸ“¤ uploadToStorage.js        # File upload handler
â”‚   â”œâ”€â”€ ğŸ“‚ scheduler/                # Scheduled functions
â”‚   â”œâ”€â”€ ğŸ“‚ utils/                    # Utility modules
â”‚   â”‚   â”œâ”€â”€ ğŸ§  dataManager.js        # Advanced data processing
â”‚   â”‚   â”œâ”€â”€ ğŸ’¾ storage.js            # File management
â”‚   â”‚   â”œâ”€â”€ ğŸ” security.js           # Security utilities
â”‚   â”‚   â””â”€â”€ âœ… validation.js         # Input validation
â”‚   â”œâ”€â”€ ğŸ“‚ test/                     # Test files
â”‚   â”œâ”€â”€ ğŸ“¦ package.json             # Dependencies
â”‚   â”œâ”€â”€ ğŸ”§ .env                     # Environment variables
â”‚   â””â”€â”€ ğŸ” production-check.js      # System health check
â”œâ”€â”€ ğŸ“‚ public/                       # Static web files
â”‚   â”œâ”€â”€ ğŸŒ liff-register.html        # LIFF registration form
â”‚   â”œâ”€â”€ ğŸ‘¨â€ğŸ’¼ adminDashboard.html       # Admin control panel
â”‚   â””â”€â”€ ğŸ› debug-admin.js           # Debug utilities
â”œâ”€â”€ âš™ï¸ firebase.json                 # Firebase configuration
â”œâ”€â”€ ğŸ”’ firestore.rules              # Database security rules
â”œâ”€â”€ ğŸ“ storage.rules                # Storage security rules
â”œâ”€â”€ ğŸ“Š firestore.indexes.json       # Database indexes
â””â”€â”€ ğŸ“– README.md                    # Documentation
```

---

## ğŸ› ï¸ **Installation & Setup**

### **Prerequisites**
- Node.js 18+ 
- Firebase CLI
- LINE Developer Account
- Firebase Project

### **1. Clone & Install**

```bash
# Clone repository
git clone https://github.com/your-username/BaanTK.git
cd BaanTK

# Install Firebase CLI (if not installed)
npm install -g firebase-tools

# Login to Firebase
firebase login

# Install dependencies
cd functions
npm install
```

### **2. Firebase Setup**

```bash
# Initialize Firebase project
firebase init

# Select: Functions, Firestore, Storage, Hosting
# Choose your Firebase project
# Select JavaScript for functions
```

### **3. Environment Configuration**

à¸ªà¸£à¹‰à¸²à¸‡à¹„à¸Ÿà¸¥à¹Œ `functions/.env`:

```env
# LINE Bot Configuration
CHANNEL_ACCESS_TOKEN=your_line_channel_access_token
CHANNEL_SECRET=your_line_channel_secret

# Firebase Configuration  
GOOGLE_PROJECT_ID=your_firebase_project_id
GOOGLE_CLIENT_EMAIL=your_firebase_client_email
GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYOUR_PRIVATE_KEY\n-----END PRIVATE KEY-----\n"

# Government API Configuration
GOVERNMENT_API_KEY=your_government_api_key
CITIZEN_REGISTRY_URL=https://api.dopa.go.th/citizen
DISTRICT_API_URL=https://api.dopa.go.th/district

# Admin Configuration
ADMIN_TOKEN=your_secure_admin_token
ADMIN_SECRET_TOKEN=alternative_admin_token

# Notification Settings (Optional)
ENABLE_SMS_NOTIFICATIONS=false
ENABLE_EMAIL_NOTIFICATIONS=false
SMS_API_KEY=your_sms_api_key
EMAIL_API_KEY=your_email_api_key

# PromptPay Configuration
PROMPTPAY_ID=0858294254
```

### **4. LINE Developer Setup**

1. **à¸ªà¸£à¹‰à¸²à¸‡ LINE Bot Channel:**
   - à¹€à¸‚à¹‰à¸² [LINE Developer Console](https://developers.line.biz/console/)
   - à¸ªà¸£à¹‰à¸²à¸‡ Provider à¹à¸¥à¸° Messaging API Channel
   - à¸„à¸±à¸”à¸¥à¸­à¸ Channel Access Token à¹à¸¥à¸° Channel Secret

2. **à¸ªà¸£à¹‰à¸²à¸‡ LIFF App:**
   - à¹„à¸›à¸—à¸µà¹ˆ LIFF Tab à¹ƒà¸™à¸à¸¥à¸¸à¹ˆà¸¡ Channel
   - à¸ªà¸£à¹‰à¸²à¸‡ LIFF App à¹ƒà¸«à¸¡à¹ˆ
   - Endpoint URL: `https://your-project.web.app/liff-register.html`
   - Scope: `profile openid`

3. **à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Webhook:**
   - Webhook URL: `https://us-central1-your-project.cloudfunctions.net/api/webhook`
   - à¹€à¸›à¸´à¸”à¹ƒà¸Šà¹‰à¸‡à¸²à¸™ Webhook

---

## ğŸš€ **Deployment**
### **1. Deploy Functions**

```bash
# Deploy all functions
firebase deploy --only functions

# à¸«à¸£à¸·à¸­ Deploy à¹€à¸‰à¸à¸²à¸° function
firebase deploy --only functions:api
```

### **2. Deploy Frontend**

```bash
# Deploy static files
firebase deploy --only hosting

# à¸«à¸£à¸·à¸­ Deploy à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
firebase deploy
```

### **3. Verify Deployment**

```bash
# à¸£à¸±à¸™à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸°à¸šà¸š
cd functions
node production-check.js
```

```bash
# Deploy all functions
firebase deploy --only functions

# à¸«à¸£à¸·à¸­ Deploy à¹€à¸‰à¸à¸²à¸° function
firebase deploy --only functions:api
```

### **2. Deploy Frontend**

```bash
# Deploy static files
firebase deploy --only hosting

# à¸«à¸£à¸·à¸­ Deploy à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
firebase deploy
```

### **3. Verify Deployment**

```bash
# à¸£à¸±à¸™à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸°à¸šà¸š
cd functions
node production-check.js
```

---

## ğŸ“± **Usage Guide**

### **For Customers (LINE Bot)**

1. **à¹€à¸à¸´à¹ˆà¸¡à¹€à¸à¸·à¹ˆà¸­à¸™ LINE Bot**
2. **à¸à¸´à¸¡à¸à¹Œ "à¹€à¸¡à¸™à¸¹"** - à¸”à¸¹à¸•à¸±à¸§à¹€à¸¥à¸·à¸­à¸à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™
3. **à¸à¸´à¸¡à¸à¹Œ "à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™"** - à¹€à¸£à¸´à¹ˆà¸¡à¸à¸£à¸°à¸šà¸§à¸™à¸à¸²à¸£à¸ªà¸¡à¸±à¸„à¸£à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­
   - à¸à¸£à¸­à¸à¹€à¸¥à¸‚à¸šà¸±à¸•à¸£à¸›à¸£à¸°à¸Šà¸²à¸Šà¸™ 13 à¸«à¸¥à¸±à¸
   - à¸£à¸°à¸šà¸šà¸ˆà¸°à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡à¸ˆà¸²à¸à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸²à¸©à¸à¸£
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸¥à¸°à¸¢à¸·à¸™à¸¢à¸±à¸™à¸„à¸§à¸²à¸¡à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡
   - à¹€à¸¥à¸·à¸­à¸à¸ˆà¸³à¸™à¸§à¸™à¹€à¸‡à¸´à¸™à¸à¸¹à¹‰à¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¸–à¸µà¹ˆà¸à¸²à¸£à¸œà¹ˆà¸­à¸™à¸Šà¸³à¸£à¸°
4. **à¸à¸´à¸¡à¸à¹Œ "à¸ªà¸–à¸²à¸™à¸°"** - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸–à¸²à¸™à¸°à¸à¸²à¸£à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´
5. **à¸à¸´à¸¡à¸à¹Œ "à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¸šà¸±à¸•à¸£"** - à¸ªà¹ˆà¸‡à¸£à¸¹à¸›à¸šà¸±à¸•à¸£à¸›à¸£à¸°à¸Šà¸²à¸Šà¸™

**ğŸ›ï¸ à¸à¸²à¸£à¸¢à¸·à¸™à¸¢à¸±à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸²à¸©à¸à¸£:**
- à¸£à¸°à¸šà¸šà¸ˆà¸°à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹à¸¥à¸°à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡à¸ˆà¸²à¸à¸à¸£à¸¡à¸à¸²à¸£à¸›à¸à¸„à¸£à¸­à¸‡
- à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸–à¸²à¸™à¸°à¸šà¸±à¸•à¸£à¸›à¸£à¸°à¸Šà¸²à¸Šà¸™ (à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸, à¸¢à¸à¹€à¸¥à¸´à¸, à¹€à¸ªà¸µà¸¢à¸Šà¸µà¸§à¸´à¸•)
- à¹€à¸›à¸£à¸µà¸¢à¸šà¹€à¸—à¸µà¸¢à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸à¸£à¸­à¸à¸à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡à¸ˆà¸²à¸à¸£à¸²à¸Šà¸à¸²à¸£
- à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸à¸£à¸­à¸à¸Šà¸·à¹ˆà¸­-à¸™à¸²à¸¡à¸ªà¸à¸¸à¸¥ à¹€à¸à¸£à¸²à¸°à¸£à¸°à¸šà¸šà¸ˆà¸°à¸”à¸¶à¸‡à¸ˆà¸²à¸à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸²à¸©à¸à¸£

### **For Admins (Web Dashboard)**

1. **à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š:** `https://your-project.web.app/adminDashboard.html`
2. **à¹ƒà¸ªà¹ˆ Admin Token** à¸—à¸µà¹ˆà¸à¸³à¸«à¸™à¸”à¹„à¸§à¹‰à¹ƒà¸™ .env
3. **à¸ˆà¸±à¸”à¸à¸²à¸£à¸„à¸³à¸‚à¸­:** à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´/à¸›à¸à¸´à¹€à¸ªà¸˜ à¹ƒà¸™ Borrowers tab
4. **à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸à¸²à¸£à¸Šà¸³à¸£à¸°:** à¹ƒà¸™ Payment Slips tab  
5. **à¸”à¸¹à¸£à¸²à¸¢à¸‡à¸²à¸™:** à¸ªà¸–à¸´à¸•à¸´à¹à¸¥à¸°à¸à¸£à¸²à¸Ÿà¹ƒà¸™ Dashboard

---

## ğŸ”§ **API Endpoints**

### **Public Endpoints**
```
POST /webhook                          # LINE Bot webhook
POST /api/liff-register               # LIFF registration
```

### **Admin Endpoints (Require Authorization)**
```
GET  /api/admin/borrowers             # Get all borrowers
GET  /api/admin/slips                 # Get payment slips  
GET  /api/admin/images                # Get uploaded images
POST /api/admin/approve               # Approve/reject loans
POST /api/admin/generate-report       # Generate reports
POST /api/admin/credit-score          # Check credit score
POST /api/admin/blacklist             # Manage blacklist
```

### **Utility Endpoints**
```
POST /send-reminder                   # Send payment reminders
POST /check-due                       # Check due dates
```

---

## ğŸ“Š **Database Schema**

### **Collections**

#### **borrowers**
```javascript
{
  userId: "LINE_USER_ID",
  requestId: "req_xxxxx",
  
  // à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§à¸ˆà¸²à¸à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸²à¸©à¸à¸£
  titleName: "à¸™à¸²à¸¢",
  firstName: "à¸ªà¸¡à¸Šà¸²à¸¢", // à¸ˆà¸²à¸à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸²à¸©à¸à¸£
  lastName: "à¹ƒà¸ˆà¸”à¸µ", // à¸ˆà¸²à¸à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸²à¸©à¸à¸£
  birthDate: "01/01/1999",
  idCard: "1120300144421",
  gender: "à¸Šà¸²à¸¢",
  nationality: "à¹„à¸—à¸¢",
  religion: "à¸à¸¸à¸—à¸˜",
  
  // à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆ
  address: "à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¸à¸£à¸­à¸",
  officialAddress: "à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¸ˆà¸²à¸à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸£à¸²à¸©à¸à¸£",
  addressDetails: {
    houseNumber: "123",
    village: "à¸«à¸¡à¸¹à¹ˆ 5",
    subDistrict: "à¸¥à¸²à¸”à¸¢à¸²à¸§",
    district: "à¸ˆà¸•à¸¸à¸ˆà¸±à¸à¸£",
    province: "à¸à¸£à¸¸à¸‡à¹€à¸—à¸à¸¡à¸«à¸²à¸™à¸„à¸£",
    postalCode: "10900"
  },
  
  // à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­
  amount: 5000,
  frequency: "monthly",
  loanTerms: {
    principal: 5000,
    interestRate: 0.10,
    totalWithInterest: 5500,
    installmentAmount: 458,
    dueDate: Timestamp
  },
  
  // à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡
  creditAssessment: {
    score: 720,
    grade: "A",
    riskLevel: "low"
  },
  creditHistory: {
    creditScore: 720,
    totalDebt: 150000,
    activeLoans: 2
  },
  
  // à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸šà¸±à¸•à¸£à¸›à¸£à¸°à¸Šà¸²à¸Šà¸™
  idCardStatus: "active",
  idCardIssueDate: "01/01/2020",
  idCardExpiryDate: "01/01/2030",
  
  // à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸£à¸°à¸šà¸š
  dataSource: "government_registry",
  verificationTimestamp: "2024-01-01T00:00:00.000Z",
  status: "pending", // pending, approved, rejected
  paid: 0,
  createdAt: Timestamp,
  approvedAt: Timestamp
}
```

#### **slips**
```javascript
{
  userId: "LINE_USER_ID",
  date: "à¸§à¸±à¸™à¸—à¸µà¹ˆà¹‚à¸­à¸™",
  amount: 5500,
  createdAt: Timestamp,
  status: "pending" // pending, verified, rejected
}
```

#### **images**  
```javascript
{
  userId: "LINE_USER_ID",
  url: "https://storage.googleapis.com/...",
  createdAt: Timestamp
}
```

---

## ğŸ§ª **Testing**

### **Unit Tests**
```bash
cd functions
npm test
```

### **System Health Check**
```bash
cd functions  
node production-check.js
```

### **Manual Testing**
1. **LINE Bot:** à¸—à¸”à¸ªà¸­à¸šà¸—à¸¸à¸ command à¹ƒà¸™ LINE
2. **LIFF:** à¸—à¸”à¸ªà¸­à¸šà¸à¸²à¸£à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™
3. **Admin:** à¸—à¸”à¸ªà¸­à¸šà¸à¸²à¸£ login à¹à¸¥à¸°à¸ˆà¸±à¸”à¸à¸²à¸£à¸‚à¹‰à¸­à¸¡à¸¹à¸¥

---

## ğŸ”’ **Security Considerations**

### **Environment Variables**
- à¹€à¸à¹‡à¸š sensitive data à¹ƒà¸™ `.env` à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
- à¹„à¸¡à¹ˆ commit `.env` à¹€à¸‚à¹‰à¸² Git
- à¹ƒà¸Šà¹‰ Firebase Environment Config à¸ªà¸³à¸«à¸£à¸±à¸š production

### **Authentication**
- Admin dashboard à¹ƒà¸Šà¹‰ Token-based authentication
- LINE webhook verification à¸”à¹‰à¸§à¸¢ signature
- Rate limiting à¸ªà¸³à¸«à¸£à¸±à¸š API endpoints

### **Data Validation**
- Validate input à¸—à¸¸à¸ endpoint
- Sanitize à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¹ˆà¸­à¸™à¹€à¸à¹‡à¸š database
- à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š file type à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£ upload

---

## ğŸ“ˆ **Performance Optimization**

### **Firebase Functions**
- à¹ƒà¸Šà¹‰ Connection pooling à¸ªà¸³à¸«à¸£à¸±à¸š database
- Lazy loading à¸ªà¸³à¸«à¸£à¸±à¸š modules
- Memory management à¸ªà¸³à¸«à¸£à¸±à¸š large files

### **Frontend**
- CSS minification
- Image optimization
- Lazy loading à¸ªà¸³à¸«à¸£à¸±à¸š components

### **Database**
- Proper indexing
- Query optimization
- Data pagination

---

## ğŸ› **Troubleshooting**

### **Common Issues**

**1. LINE Bot à¹„à¸¡à¹ˆà¸•à¸­à¸š:**
```bash
# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š webhook URL
firebase functions:log --only api

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š environment variables
cd functions && node -e "require('dotenv').config(); console.log(process.env.CHANNEL_ACCESS_TOKEN)"
```

**2. Admin Dashboard à¹„à¸¡à¹ˆà¹‚à¸«à¸¥à¸”:**
```bash
# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š CORS configuration
# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Admin Token
# à¸”à¸¹ Browser Console à¸ªà¸³à¸«à¸£à¸±à¸š errors
```

**3. LIFF à¹„à¸¡à¹ˆà¸—à¸³à¸‡à¸²à¸™:**
```bash
# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š LIFF URL à¹ƒà¸™ LINE Developer Console
# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Endpoint URL
# à¸—à¸”à¸ªà¸­à¸šà¹ƒà¸™ LINE Browser
```

**4. File Upload à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§:**
```bash
# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Storage Rules
# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š file size limit
# à¸”à¸¹ Functions logs
```

---

## ğŸ¤ **Contributing**

1. Fork the repository
2. Create feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit changes (`git commit -m 'Add AmazingFeature'`)
4. Push to branch (`git push origin feature/AmazingFeature`)
5. Open Pull Request

---

## ğŸ“„ **License**

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## ğŸ“ **Support**

- **Documentation:** [Wiki](https://github.com/your-username/BaanTK/wiki)
- **Issues:** [GitHub Issues](https://github.com/your-username/BaanTK/issues)
- **Discussions:** [GitHub Discussions](https://github.com/your-username/BaanTK/discussions)

---

## ğŸ™ **Acknowledgments**

- Firebase Team à¸ªà¸³à¸«à¸£à¸±à¸š cloud platform à¸—à¸µà¹ˆà¸¢à¸­à¸”à¹€à¸¢à¸µà¹ˆà¸¢à¸¡
- LINE Developer Team à¸ªà¸³à¸«à¸£à¸±à¸š Bot API à¹à¸¥à¸° LIFF
- Open Source Community à¸ªà¸³à¸«à¸£à¸±à¸š libraries à¹à¸¥à¸° tools

---

**ğŸ¯ BaanTK - Making loan management simple and efficient**

![Made with â¤ï¸](https://img.shields.io/badge/Made%20with-â¤ï¸-red)
![Powered by Firebase](https://img.shields.io/badge/Powered%20by-Firebase-orange)
![Built for LINE](https://img.shields.io/badge/Built%20for-LINE-green)
